{% extends 'cmdb/base.html' %}
{#标题#}
{% block page_title %}数据库清单{% endblock %}

{#内容导航条部分#}
{% block content_header %}
    数据库清单
{% endblock %}
{% block content_header_2 %}
    数据库清单
{% endblock %}

<!--内容区域-->
{% block main_content %}
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">以下是我们记录的所有内容</h3>
                </div>
                <div class="card-body">
                    <table id="example1" class="table table-bordered table-hover">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>数据库名称</th>
                            <th>数据库版本</th>
                            <th>管理IP</th>
                            <th>数据库端口号</th>
                            <th>数据库用户名</th>
                            <th>数据库密码</th>
                            <th>更新者</th>
                            <th>更新日期</th>
                            <th>备注</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td></td>
                            <td>Internet Explorer 4.0</td>
                            <td>Win 95+</td>
                            <td> 4</td>
                            <td>X</td>
                            <td>Trident</td>
                            <td>Internet Explorer 4.0</td>
                            <td>Win 95+</td>
                            <td> 4</td>
                            <td>X</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block user_js %}
    <script type="text/javascript">
        $(document).ready(function () {
            $(function () {
                $("#example1").DataTable({
                    "responsive": true,
                    "autoWidth": false,
                    // 是否开启本地分页
                    "paging": true,
                    // 是否开启本地排序
                    "ordering": true,
                    // 是否显示左下角信息
                    "info": true,
                    // 是否允许用户改变表格每页显示的记录数
                    "lengthChange": true,
                    // 是否显示处理状态(排序的时候，数据很多耗费时间长的话，也会显示这个)
                    "processing": true,
                    // 是否允许 DataTables 开启本地搜索
                    "searching": true,
                    // 是否开启服务器模式;如果是服务器请求数据,则下面设置为true
                    "serverSide": false,
                    // 控制 DataTables 的延迟渲染，可以提高初始化的速度
                    "deferRender": true,
                    // 分页按钮显示选项
                    "pagingType": "full_numbers",
                    // 增加或修改通过 Ajax 提交到服务端的请求数据
                    "ajax": {
                        "dataType": 'json',
                        "url": "/cmdb/data_database",
                        "type": "POST",
                        "dataSrc": 'data'
                    },
                    // 给datatable自动编号
                    "fnDrawCallback": function () {
                        this.api().column(0).nodes().each(function (cell, i) {
                            cell.innerHTML = i + 1;
                        });
                    },
                    //使表格第四列不显示不可搜索不可排序
                    columnDefs: [{'targets': [9], 'visiblie': true, 'searchable': false, 'sortable': false}],

                    // 设置列的数据源
                    "columns": [
                        {"data": null},
                        {"data": "db_type"},
                        {
                            "data": 'db_type',
                            "render": function (data, type, row, meta) {
                                //这个效果是超过的 隐藏，类似效果自己扩展吧
                                if (data === 'MSSQL') {
                                    return '<i class="fas fa-th-large"></i>'
                                } else if (data === '2008') {
                                    return '<i class="fa fa-apple-alt" aria-hidden="true"></i>'
                                } else {
                                    return '未知'
                                }

                            }
                        },
                        {
                            "data": "manage_ip"
                        },
                        {
                            "data": "port",
                            "render": function (data, type, row, meta) {
                                //这个效果是超过的 隐藏，类似效果自己扩展吧
                                return "<div style='width:150px;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;'" + "title='" + data + "'>" + data + "</div>";
                            }
                        },

                        {"data": "username"},
                        {"data": "password"},
                        {
                            "data": 'updator'
                        },
                        {
                            "data": "update_time",
                            "render": function (data, type, row, meta) {
                                //这个效果是超过的 隐藏，类似效果自己扩展吧
                                return "<div style='width:150px;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;'" + "title='" + data + "'>" + data + "</div>";
                            }
                        },
                        {
                            "data": "memo"
                        }
                    ],
                    // 国际化
                    "language":
                        {
                            "sProcessing":
                                "处理中...",
                            "sLengthMenu":
                                "显示 _MENU_ 项结果",
                            "sZeroRecords":
                                "没有匹配结果",
                            "sInfo":
                                "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                            "sInfoEmpty":
                                "显示第 0 至 0 项结果，共 0 项",
                            "sInfoFiltered":
                                "(由 _MAX_ 项结果过滤)",
                            "sInfoPostFix":
                                "",
                            "sSearch":
                                "搜索:",
                            "sUrl":
                                "",
                            "sEmptyTable":
                                "表中数据为空",
                            "sLoadingRecords":
                                "载入中...",
                            "sInfoThousands":
                                ",",
                            "oPaginate":
                                {
                                    "sFirst":
                                        "首页",
                                    "sPrevious":
                                        "上页",
                                    "sNext":
                                        "下页",
                                    "sLast":
                                        "末页"
                                }
                            ,
                            "oAria":
                                {
                                    "sSortAscending":
                                        ": 以升序排列此列",
                                    "sSortDescending":
                                        ": 以降序排列此列"
                                }
                        },


                });
            });

        });

    </script>
{% endblock %}
